<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Leak Test for ActiveXObjects</title>
<meta http-equiv="refresh" content="2;url=">
</head>
<body>
<h3>Leak Test for ActiveXObjects</h3>
<p>Be sure to have your memory profiler open.  I recommend using <a href="http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx">Process Explorer</a></p>
<script type="text/javascript">
  // http://gyazo.com/330b6b2f7809db8a12549b523db8efc0.png
  (function() {
    var data = { };
    var i =-1, l = 1000;
    while (++i < l) {
      (function(i) {
        data[i] = new ActiveXObject('Microsoft.XMLHTTP');
        data[i].onreadystatechange = function(){
          if (data[i].readyState == 4) {
            alert(data[i].responseText);
          }
        };
      })(i);
    }
  })();
</script>
</body>
</html>

